res = 0

def assert_equals(a,b)
  raise "failed #{a} == #{b}" unless a.eql?(b)
end

def trim(s)
  return trim(s[1..]) if s.start_with?(".")
  return trim(s[0..-2]) if s.end_with?(".")
  s
end

def reduce_dots(s)
  return reduce_dots(s.gsub("..",".")) if s.include?("..")
  s
end

def trim_reduce(s)
  trim(reduce_dots(s))
end

def generate_tests(s)
  s = trim_reduce(s)
  if s.start_with?("?")
    return generate_tests("#{s[1..]}") + generate_tests("##{s[1..]}")
  else 
    return [s]
  end
end

def update_cache_and_return(s,v,p,cache,value)
  key = "#{s}::#{v.inspect}::p"
  cache[key] = value
  return value
end

def check_match_one(s,v,p,cache)
  key = "#{s}::#{v.inspect}::p"
  return cache[key] if cache.key?(key)
  # puts "CMO: #{s} :: #{v.inspect}"
  if v.size.eql?(1) && v.first.eql?(0)
    return update_cache_and_return(s,v,p,cache,1) if s.empty?
    return update_cache_and_return(s,v,p,cache,1) if s.split("").all? {|c| c.eql?("?") || c.eql?(".") }
    return update_cache_and_return(s,v,p,cache,0)
  end
  return update_cache_and_return(s,v,p,cache,0) if s.empty? || v.empty? # && v.size.eql?(1) && v.first > 0
  return update_cache_and_return(s,v,p,cache,0) if s.empty? && v.size>=1 && v.first > 0
  case s[0]
  when "."
    return update_cache_and_return(s,v,p,cache,check_match_one(s[1..], v, ".", cache)) if p.eql?(".")
    return update_cache_and_return(s,v,p,cache,0) unless v.first.eql?(0)
    return update_cache_and_return(s,v,p,cache,check_match_one(s[1..], v[1..], ".", cache))
  when "#"
    return 0 unless v.first > 0
    v2 = v[0..]
    v2[0] -= 1
    return update_cache_and_return(s,v,p,cache,check_match_one(s[1..], v2, "#", cache))
  when "?"
    psum = 0
    # 2 cases
    # .
    if v.first.eql?(0)
      psum += check_match_one(s[1..], v[1..], ".", cache)
    else
      if p.eql?(".")
        psum += check_match_one(s[1..], v, ".",cache) 
      end
    end 
    # #
    if v.first > 0
      v2 = v[0..]
      v2[0] -= 1
      psum += check_match_one(s[1..], v2, "#", cache)
    end
    return update_cache_and_return(s,v,p,cache,psum)
  else
    raise "unexpected |#{s}|#{v}|#{p}}"
  end
end

def check_match(s, v)
  cache = {}
  puts "CM: #{s} w/ #{v.inspect}"
  sum = 0
  generate_tests(s).each do |s1|
    res = check_match_one(s1,v,"", cache)
    puts "G: #{s1} => #{res}" 
    sum += res
  end
  return sum
end

# these are the tests based on the dumb slow way part 1 - known to be correct ran
# use them to validate part 2
assert_equals(check_match("#?#???????.????#",[1, 2, 3, 2, 1]),6)
assert_equals(check_match("??????????",[1, 1, 4]),10)
assert_equals(check_match("????.??.??.???",[1, 2]),27)
assert_equals(check_match("??????#??????.?",[2, 4, 1, 1, 1]),16)
assert_equals(check_match("?.?#??.?.#####????",[2, 9]),2)
assert_equals(check_match("???#?.??.????",[3, 1, 1]),22)
assert_equals(check_match("???????.?#",[2, 3, 2]),3)
assert_equals(check_match("?.#????#??.#?",[4, 3, 1]),1)
assert_equals(check_match("?????.??????###??",[1, 6]),24)
assert_equals(check_match("####?????#.?.?#?",[7, 1, 2]),2)
assert_equals(check_match("#????#????.??????.#?",[1, 1, 5, 2, 1, 2]),18)
assert_equals(check_match("??#?.#???#?",[1, 1, 1, 1]),2)
assert_equals(check_match("??#???##.??????",[7, 2, 1]),6)
assert_equals(check_match("????????????.??#???",[1, 1, 7, 1, 1]),12)
assert_equals(check_match("?????????#",[1, 5, 1]),3)
assert_equals(check_match("?#?.#????#????#????",[2, 2, 1, 4, 1]),14)
assert_equals(check_match("?.??#????###",[3, 3]),3)
assert_equals(check_match("????##??????##??",[1, 3, 9]),2)
assert_equals(check_match("????????",[1, 2]),15)
assert_equals(check_match("?#.????#",[1, 2, 1]),2)
assert_equals(check_match("?.??#????.##??",[1, 1, 3, 1, 4]),1)
assert_equals(check_match("??.??#?##?##??",[1, 5, 2]),2)
assert_equals(check_match("?#.?????.?#??",[1, 1, 2, 1]),8)
assert_equals(check_match("?#??.?#?#??????#?#?",[3, 14]),2)
assert_equals(check_match("#???##??.??",[8, 1]),2)
assert_equals(check_match("#?.#??????##?.?",[1, 1, 7, 1]),2)
assert_equals(check_match("??.#??#??#",[1, 1, 5]),2)
assert_equals(check_match("??#???##?###??.???",[13, 1, 1]),2)
assert_equals(check_match("?##????#?????",[9, 1]),5)
assert_equals(check_match("?.??.##?.??",[1, 3]),3)
assert_equals(check_match("?#??#?.???",[5, 1, 1]),2)
assert_equals(check_match("???#?#?.???#?#?#",[6, 8]),2)
assert_equals(check_match("??.?#?#?????",[2, 5, 1, 1]),1)
assert_equals(check_match("#?#?##.??.?#??#?.??",[6, 1, 5, 2]),4)
assert_equals(check_match("?.??#.#?????????",[1, 3, 1, 1, 2]),16)
assert_equals(check_match("?.??.????#?.???#???",[1, 1, 1, 3, 7]),6)
assert_equals(check_match("??###?.??##?#?",[5, 5]),4)
assert_equals(check_match("????#???.???#??",[7, 2]),4)
assert_equals(check_match("????.?????#",[3, 1]),4)
assert_equals(check_match("#?##??.?.?##??#?#?#",[5, 1, 7, 1]),1)
assert_equals(check_match("??##.#?.#?.??",[4, 1, 2, 1]),2)
assert_equals(check_match("????.???.#?#?",[4, 2, 3]),2)
assert_equals(check_match("???????#.?????",[1, 6, 4]),2)
assert_equals(check_match("#??????#.?.??.?#???",[3, 4, 1, 1, 3, 1]),2)
assert_equals(check_match("?#?##?.#??",[4, 1]),1)
assert_equals(check_match("?##???.#???#?#???",[4, 1, 3, 1]),6)
assert_equals(check_match("?#??##?????#?",[8, 3]),3)
assert_equals(check_match("?.?.?????#??????#??",[1, 8, 3, 1]),4)
assert_equals(check_match("????#?.??#????",[4, 5]),6)
assert_equals(check_match("?#.#??????#?.?",[1, 1, 5, 1]),2)
assert_equals(check_match("??##??#??.?",[2, 3]),2)
assert_equals(check_match("??????.#???",[5, 3]),2)
assert_equals(check_match("????????#???",[2, 2, 1, 1]),13)
assert_equals(check_match("#?#?##???????#??",[8, 4]),3)
assert_equals(check_match("?????.??????.#?#???",[3, 6, 1, 1, 1]),6)
assert_equals(check_match("??.??.#?#.#?????#.#",[2, 1, 1, 1, 7, 1]),2)
assert_equals(check_match("??.????????#???",[1, 9]),11)
assert_equals(check_match("??.?????#?.????",[1, 3, 1, 3]),8)
assert_equals(check_match("???.?.#?????",[2, 1, 3]),6)
assert_equals(check_match("#?????????",[1, 5, 1]),3)
assert_equals(check_match("????#??.???#?????",[2, 8]),4)
assert_equals(check_match("????.??.??#????",[2, 1, 1]),24)
assert_equals(check_match("?.??????",[1, 4]),4)
assert_equals(check_match("?#?#.#??.?#??#.???",[3, 3, 4, 1, 1]),1)
assert_equals(check_match("#.???.??",[1, 2]),3)
assert_equals(check_match("?.??#??#???#",[2, 2, 1]),3)
assert_equals(check_match("##???.???????",[5, 1, 2]),10)
assert_equals(check_match("#???##??????.??#",[1, 5, 2, 1, 3]),1)
assert_equals(check_match("#.?.??#?????",[1, 1, 3, 1]),11)
assert_equals(check_match("??##?#.?#?#??#",[5, 1, 1, 1]),1)
assert_equals(check_match("?????#?.??.?.?#???",[1, 2, 2, 1, 1, 1]),22)
assert_equals(check_match("??##??????",[1, 5, 1]),2)
assert_equals(check_match("?.???????#.??",[1, 3, 1]),17)
assert_equals(check_match("???????#?##?#??",[3, 9]),6)
assert_equals(check_match("??.?#????????#?.#??",[1, 12, 1]),2)
assert_equals(check_match("??#?#??.????.?",[1, 5, 3, 1]),2)
assert_equals(check_match("#?.?.?.??",[1, 1, 1]),5)
assert_equals(check_match("??#??.?#??????.??",[4, 1, 1, 1]),32)
assert_equals(check_match("#??##??#??",[1, 6]),2)
assert_equals(check_match("??.#???.???.?",[1, 1]),8)
assert_equals(check_match("???#??.?",[6, 1]),1)
assert_equals(check_match("??.??.#?????#.?#??",[2, 4, 2, 2]),4)
assert_equals(check_match("???.?????.?#??#.??",[1, 4, 5]),6)
assert_equals(check_match("?#??#??.??#?##?",[6, 4]),2)
assert_equals(check_match("?#?##?.??.??##??#",[6, 7]),1)
assert_equals(check_match("???????#????",[2, 4]),14)
assert_equals(check_match("#?.#?????#??.???",[1, 2, 4, 3]),3)
assert_equals(check_match("?????????#?",[1, 6, 1]),1)
assert_equals(check_match("?.?##??.#.?",[4, 1]),2)
assert_equals(check_match("#?????#.?.?#??#???",[1, 5, 1, 1, 2, 1]),3)
assert_equals(check_match("???.?????.#??#.?#",[1, 4, 1, 1, 1]),6)
assert_equals(check_match("?.?#???.?.?#?",[4, 1]),2)
assert_equals(check_match("##.??????##??#????",[2, 1, 1, 2, 1, 2]),12)
assert_equals(check_match("#?.#????#?#????#?",[2, 1, 3, 7]),1)
assert_equals(check_match("?#?##?#????#????",[12, 1]),5)
assert_equals(check_match("?????????#???",[1, 3]),21)
assert_equals(check_match("????##?.#?????#",[1, 2, 2, 2]),3)
assert_equals(check_match("#.?.????#???.#??#???",[1, 1, 3, 4, 5]),1)
assert_equals(check_match("?#??#?#.?##.?####?",[7, 3, 4]),1)
assert_equals(check_match("????????#?#",[3, 2, 1, 1]),3)
assert_equals(check_match("??????#?#??#??",[6, 2]),3)
assert_equals(check_match("???.????.??",[2, 4]),2)
assert_equals(check_match("??##???##.??",[5, 2]),2)
assert_equals(check_match("??#.#?.?#???",[1, 2, 2, 2]),1)
assert_equals(check_match("?#????#??#??????",[1, 1, 2, 1, 2]),16)
assert_equals(check_match("??.?#?#?#??.??????",[6, 2]),10)
assert_equals(check_match("???????#??.??????#?",[1, 4, 3, 2, 1, 2]),4)
assert_equals(check_match("#??#???##???",[9, 1]),2)
assert_equals(check_match("???.?????",[1, 1, 2]),13)
assert_equals(check_match("??#??.???#???.#?",[1, 3, 1, 4, 1]),3)
assert_equals(check_match("??.#?.???#?#?.?",[2, 2, 1, 4, 1]),3)
assert_equals(check_match("#????##??#.??",[1, 5]),1)
assert_equals(check_match("????.?#???",[2, 1]),6)
assert_equals(check_match("?#?#.?.?.????##",[1, 1, 1, 1, 2]),8)
assert_equals(check_match("???#?????.?#??#.?",[4, 1, 4, 1]),10)
assert_equals(check_match("?.??.?.?##??",[1, 1, 1, 4]),4)
assert_equals(check_match("##??#????#.?.#?#",[3, 4, 1, 1, 3]),1)
assert_equals(check_match("#.??.??#??",[1, 2, 3]),3)
assert_equals(check_match("????.##.??",[1, 2, 1]),8)
assert_equals(check_match("#.?????????#",[1, 5, 2, 1]),1)
assert_equals(check_match("?#?#????#??????",[2, 1, 3, 2, 1]),4)
assert_equals(check_match("?#?.?##?#??",[2, 5, 1]),2)
assert_equals(check_match("??#????.???",[7, 1]),3)
assert_equals(check_match("?#???#?.?.?.??",[1, 4, 1, 1]),5)
assert_equals(check_match("????##.#.??#??#???",[6, 1, 1, 7]),1)
assert_equals(check_match("???????#?##??",[2, 7]),9)
assert_equals(check_match("?.?#?#???#?#.??.???",[1, 1, 1, 5, 2, 3]),1)
assert_equals(check_match("????#?#?.?????.#",[6, 2, 1]),8)
assert_equals(check_match("???.#??.?.#??.??",[2, 1]),1)
assert_equals(check_match("?.?.???#?",[1, 3]),5)
assert_equals(check_match("?#????.???.??",[3, 1, 1, 1]),25)
assert_equals(check_match("#??.?.?#??",[3, 1, 1]),2)
assert_equals(check_match("?????.?????",[4, 5]),2)
assert_equals(check_match("??????????#??#???",[4, 1, 1, 1, 4]),8)
assert_equals(check_match("??#?.???#??.?????#?#",[2, 1, 4, 1, 1, 1]),8)
assert_equals(check_match("###.??.?#???#??",[3, 1, 6, 1]),2)
assert_equals(check_match("???##???.?##???##??",[5, 8]),8)
assert_equals(check_match("???##???#?.#",[6, 2, 1]),3)
assert_equals(check_match("??.???????#????",[1, 1, 3, 1, 1]),29)
assert_equals(check_match("????#.???",[1, 1, 3]),3)
assert_equals(check_match("???.??#??#???#???",[2, 4, 2]),5)
assert_equals(check_match("??#??#???????##?",[1, 1, 5, 2]),3)
assert_equals(check_match("#??#?###.?????#",[8, 2, 1, 1]),1)
assert_equals(check_match("??????????",[1, 4]),15)
assert_equals(check_match("??##???????.##?.??",[5, 2]),3)
assert_equals(check_match("?###?.????#??##??#??",[5, 11, 1]),1)
assert_equals(check_match("?##???????",[3, 1, 2]),9)
assert_equals(check_match("?##???.?#?#?##",[4, 7]),2)
assert_equals(check_match("?????##???",[2, 4, 1]),4)
assert_equals(check_match("????##????#???????",[10, 1, 1]),20)
assert_equals(check_match("????#???#.?.????",[1, 1]),1)
assert_equals(check_match("#??#????.?.?????",[4, 1, 1, 2]),28)
assert_equals(check_match("?#?.?.??#??",[1, 1, 2]),3)
assert_equals(check_match("?????.?#?",[4, 1]),2)
assert_equals(check_match("?.???????.?????",[1, 1, 1, 1, 2]),119)
assert_equals(check_match("?.???.?????#??#.?",[3, 8]),1)
assert_equals(check_match("????#?.???",[3, 1]),7)
assert_equals(check_match("???#?#??#???##???",[1, 12, 1]),4)
assert_equals(check_match("?#?.#???.??????????",[2, 4, 8]),6)
assert_equals(check_match("?#???#?????#?????",[3, 1, 5, 3]),6)
assert_equals(check_match("?.?.#???.?##??",[1, 1, 2]),4)
assert_equals(check_match("?.??.??#?#?#??",[1, 7]),10)
assert_equals(check_match("?##?#??.?#",[5, 1]),2)
assert_equals(check_match("#??#?##??#?#?",[1, 4, 2, 1]),1)
assert_equals(check_match("????####",[2, 5]),1)
assert_equals(check_match("????#????????",[7, 3]),6)
assert_equals(check_match("?#?.?#.????.?",[1, 2, 1, 1]),7)
assert_equals(check_match("????????????#???",[1, 10, 1]),7)
assert_equals(check_match("??.???#???????.??",[1, 6, 1, 1, 2]),8)
assert_equals(check_match("??.??.??????",[1, 3, 1]),12)
assert_equals(check_match("?##?????#???.?",[3, 2, 1, 1]),15)
assert_equals(check_match("?.??#??.?.????.??.??",[1, 4, 1, 1, 1, 2]),40)
assert_equals(check_match("??##????????#?????",[1, 2, 2, 8]),6)
assert_equals(check_match("???#??##.?.??",[8, 1, 1]),2)
assert_equals(check_match("??????.?#?",[3, 1]),4)
assert_equals(check_match("??.??????#?#?.?.?",[1, 6]),9)
assert_equals(check_match("?#????#???#?#?.??",[13, 2]),2)
assert_equals(check_match("#?????#???##???",[8, 2]),1)
assert_equals(check_match("???.??##.?",[1, 4, 1]),3)
assert_equals(check_match("?.?????.##???###?#??",[1, 10]),6)
assert_equals(check_match("?#?.#.?#??????",[1, 1, 8]),1)
assert_equals(check_match("?.???#???.?.#?#?#.?",[6, 5]),2)
assert_equals(check_match("#???#??#????",[1, 7]),3)
assert_equals(check_match("??###????#?##?#.#??",[12, 1, 1, 1]),1)
assert_equals(check_match("????.#.?#???.?.?",[1, 1, 2, 2, 1]),8)
assert_equals(check_match("??????#??????.??",[1, 1, 8, 1]),8)
assert_equals(check_match("??????#???",[2, 1, 3]),4)
assert_equals(check_match("???.?????",[2, 1]),13)
assert_equals(check_match("?#?#???#???#?#?.#",[4, 1, 3, 1]),2)
assert_equals(check_match("##?.???????.???",[2, 1, 2, 2, 1]),3)
assert_equals(check_match("?????.????",[2, 2]),13)
assert_equals(check_match("?##?#???????#.?",[7, 1, 1, 1]),6)
assert_equals(check_match("?#.#???.?.##??###???",[1, 1, 1, 1, 10]),2)
assert_equals(check_match("???#?#?????????##?",[1, 1, 5, 1, 1, 3]),2)
assert_equals(check_match("??.??????",[1, 4]),7)
assert_equals(check_match("?#??##???#",[5, 1]),1)
assert_equals(check_match("?.??.#?#???????##??",[1, 1, 3, 1, 1, 4]),23)
assert_equals(check_match("??.????#???#?#?????",[6, 7]),3)
assert_equals(check_match("?.#?#??????",[5, 1]),3)
assert_equals(check_match("??????.???????",[3, 4]),16)
assert_equals(check_match("???#?#?#??##???",[1, 1, 1, 7]),2)
assert_equals(check_match("????#?.?#??.??",[5, 3]),4)
assert_equals(check_match("???#.#????##????",[3, 8, 2]),1)
assert_equals(check_match("?#?#??.??#.??",[4, 3]),2)
assert_equals(check_match("##??#???.?",[5, 1, 1]),2)
assert_equals(check_match("?##?#.?##?",[4, 3]),2)
assert_equals(check_match("??.?.?#??.?????#??",[4, 3]),3)
assert_equals(check_match("#????#?##??#?.?.???",[1, 7, 3, 1, 1]),4)
assert_equals(check_match("?.#?#??##??.#?#??",[8, 4]),1)
assert_equals(check_match("?#.??#?#?",[2, 1, 2]),1)
assert_equals(check_match("????##??#?",[1, 2, 2]),6)
assert_equals(check_match("????#??##???????",[5, 3, 2, 1]),12)
assert_equals(check_match("###?????#?.???????",[3, 2, 1, 2]),32)
assert_equals(check_match("?.#?.?#?#??#?",[1, 4, 2]),3)
assert_equals(check_match("???.????##.??????",[2, 3, 2]),18)
assert_equals(check_match("?#??##??????#?",[5, 1, 1, 1]),3)
assert_equals(check_match("???#??????",[5, 1]),10)
assert_equals(check_match("?.###?????#??",[3, 5, 1]),1)
assert_equals(check_match("???.?????#?.??",[1, 6]),6)
assert_equals(check_match("???????",[1, 1]),15)
assert_equals(check_match("??????#????#?#",[7, 1, 1, 1]),3)
assert_equals(check_match("??.???#?????#???",[1, 13]),2)
assert_equals(check_match("???#?????",[1, 4, 1]),4)
assert_equals(check_match("????#??##.?#",[1, 1, 2, 2]),3)
assert_equals(check_match("?#???#???##??.#.#",[7, 4, 1, 1]),3)
assert_equals(check_match("????.?????#?",[3, 3]),5)
assert_equals(check_match("??#?#.???",[5, 3]),1)
assert_equals(check_match("??????????.?",[1, 6]),6)
assert_equals(check_match("?.?#.??.?##??????#?",[2, 1, 8, 1]),2)
assert_equals(check_match("??.#??????##?",[1, 2, 1, 3]),11)
assert_equals(check_match("????.??#.???#??",[1, 1, 3, 1, 2]),9)
assert_equals(check_match("?#????????",[1, 3]),5)
assert_equals(check_match("?#.??#.???#?.?",[2, 1, 3, 1]),2)
assert_equals(check_match("?#????.????.#",[1, 2, 2, 1]),6)
assert_equals(check_match("??.?##???#.#??",[6, 2]),1)
assert_equals(check_match("??#???#????.?",[3, 2, 2]),7)
assert_equals(check_match("?????#???#?????",[2, 6]),10)
assert_equals(check_match("#?.?.#.????",[1, 1, 1, 3]),2)
assert_equals(check_match("?###?#??#??#.???",[3, 1, 1, 1, 2]),2)
assert_equals(check_match("??##??????#??#??.#?",[6, 1, 1, 2, 1]),6)
assert_equals(check_match("?????#?##?????",[1, 1, 8]),4)
assert_equals(check_match("#??.###???#?",[2, 3, 3]),2)
assert_equals(check_match("?.#?.??????#??##?",[1, 8]),2)
assert_equals(check_match("??#?##????????#?",[6, 1, 2]),27)
assert_equals(check_match("??.??#?.######?.?.?",[3, 7, 1]),4)
assert_equals(check_match("?#??#????.?????####?",[6, 1, 2, 6]),9)
assert_equals(check_match("????????#.???#??",[4, 2]),2)
assert_equals(check_match("##??#?#???????.?#?",[3, 1, 3, 1, 1, 3]),3)
assert_equals(check_match("??.??????",[2, 1, 2]),6)
assert_equals(check_match("??.???.????",[1, 1, 1, 1]),29)
assert_equals(check_match("#?.?#??#???",[1, 4]),1)
assert_equals(check_match("??#??#????##??",[5, 4]),6)
assert_equals(check_match("#???????????",[1, 2, 2]),21)
assert_equals(check_match("???.?#??.??#??",[3, 3, 3]),6)
assert_equals(check_match("?????.????",[1, 1, 2]),23)
assert_equals(check_match("?.??.#.????##???",[1, 1, 1, 7]),9)
assert_equals(check_match("????????.?",[2, 2, 1]),14)
assert_equals(check_match("?.?#.#?#?????#????",[2, 1, 3, 5]),3)
assert_equals(check_match("????.#?.?????",[2, 1, 3]),10)
assert_equals(check_match("??.#???.??????##?##?",[1, 2, 1, 1, 7]),26)
assert_equals(check_match("??#?????.??#?#",[5, 4]),3)
assert_equals(check_match("##?#?#??#????.?",[6, 5]),2)
assert_equals(check_match("??.??????#???#.#??",[2, 1, 1, 7, 1, 1]),1)
assert_equals(check_match("#???.??.??",[3, 1]),4)
assert_equals(check_match("??#??#???",[4, 3]),1)
assert_equals(check_match("#????.#??.?????",[2, 2, 1, 1, 3]),4)
assert_equals(check_match("?#.???.??.??.?",[1, 3, 1, 1, 1]),4)
assert_equals(check_match("?????#????#?",[1, 1, 1, 1]),11)
assert_equals(check_match("??#???.#.?",[5, 1]),2)
assert_equals(check_match("?.??#????#?#??#??#?#",[1, 4, 4, 2, 1, 1]),8)
assert_equals(check_match("?.????.???#?",[3, 4]),4)
assert_equals(check_match("??#?.????#???###?#??",[2, 2, 1, 8]),8)
assert_equals(check_match("##???.?#?#???",[2, 2, 1, 3]),1)
assert_equals(check_match("?.???.?#???",[1, 3, 1]),5)
assert_equals(check_match("???????????",[3, 2]),21)
assert_equals(check_match("#.??#????##",[1, 8]),1)
assert_equals(check_match("??#?#?.??.??",[1, 4, 1, 1]),4)
assert_equals(check_match("??#????#?.#???",[7, 4]),2)
assert_equals(check_match("?????#????#??#???.?",[6, 6]),9)
assert_equals(check_match("???.#.????#????#.?",[1, 1, 1, 2, 7, 1]),1)
assert_equals(check_match("#?###???????????.?",[5, 4, 1, 2, 1]),4)
assert_equals(check_match("???##?.???#??#???",[3, 7]),8)
assert_equals(check_match("#???#.?#.?.?",[2, 2, 2, 1]),2)
assert_equals(check_match("##?????????????###??",[4, 2, 1, 2, 5]),15)
assert_equals(check_match("??.?#??#????",[1, 2, 1, 1]),13)
assert_equals(check_match("?.#.??????.?#?##?#?",[1, 1, 2, 2, 7]),6)
assert_equals(check_match("???.????",[1, 3]),6)
assert_equals(check_match("#????#?.??#?#",[2, 3, 2, 1]),2)
assert_equals(check_match("?.?##.???.?",[3, 1]),4)
assert_equals(check_match("??#?#####?##?##.???",[9, 5, 1, 1]),1)
assert_equals(check_match("????????##",[3, 2]),5)
assert_equals(check_match("??#????#.????#?????",[3, 2, 5, 1, 1]),12)
assert_equals(check_match("??.??##???",[2, 2, 1]),2)
assert_equals(check_match("??#??.??#??#?",[4, 5]),4)
assert_equals(check_match("???????#.?#",[1, 1, 1, 2]),10)
assert_equals(check_match("?#.??#?????#??#.?#.?",[1, 12, 2]),1)
assert_equals(check_match("?.#???#.?.?",[1, 1, 1, 1]),6)
assert_equals(check_match("????????#?#??#??",[2, 8, 1]),7)
assert_equals(check_match("??.?#?.###?",[1, 4]),1)
assert_equals(check_match("??##????#??.???#?",[4, 3, 1, 1, 2]),6)
assert_equals(check_match("?????.?????",[2, 3, 1]),4)
assert_equals(check_match("???#????#????#???",[1, 10]),3)
assert_equals(check_match("??????##?#???.??????",[6, 4]),10)
assert_equals(check_match("??.#?????#?#???",[2, 7, 1, 1]),2)
assert_equals(check_match("#?#?????.#??",[1, 1, 1, 1]),5)
assert_equals(check_match("?.???#???#??#??",[1, 1, 10]),3)
assert_equals(check_match("?????#?.#.?",[5, 1, 1]),2)
assert_equals(check_match("?????.??.????????##",[2, 1, 1, 10]),6)
assert_equals(check_match("???.?????",[1, 1]),22)
assert_equals(check_match("???#?????.?????###",[1, 2, 2, 2, 4]),14)
assert_equals(check_match("?.??????.??#????",[1, 2, 1, 2, 2]),32)
assert_equals(check_match("????.????",[2, 2]),9)
assert_equals(check_match("?.????.?#???????",[1, 3, 2, 4]),10)
assert_equals(check_match("?????#?.??#????",[1, 4, 1, 4]),3)
assert_equals(check_match("???.?.??.?",[3, 2]),1)
assert_equals(check_match("?.??#??????",[4, 1]),9)
assert_equals(check_match("##????#????#",[9, 1]),1)
assert_equals(check_match("??.?????????",[2, 3, 1]),19)
assert_equals(check_match("?#????#.??.??????",[4, 1, 2, 3, 1]),6)
assert_equals(check_match("????.??#?#?",[1, 5]),8)
assert_equals(check_match("#???###???.????",[1, 5, 3]),6)
assert_equals(check_match("??.???#.????#??#.#",[1, 4, 2, 5, 1]),2)
assert_equals(check_match("??##?????.?##??",[4, 3, 3]),6)
assert_equals(check_match("??.#.##?.??????",[1, 1, 2, 1, 1]),20)
assert_equals(check_match("?#.??????????",[1, 1, 1, 3]),20)
assert_equals(check_match("?#.??#???#??#?.?#??",[2, 4, 3, 2, 2]),2)
assert_equals(check_match("?.?.???.#??",[1, 2, 2]),4)
assert_equals(check_match("?.#?#?.??????",[3, 5]),2)
assert_equals(check_match("#?.???????",[2, 1]),7)
assert_equals(check_match("??????.????#?##",[1, 2, 7]),6)
assert_equals(check_match("???.????#??????",[3, 4, 1, 1]),10)
assert_equals(check_match("????#?#??.#?",[3, 4, 1]),1)
assert_equals(check_match("?.?#??#??#??#.????#",[10, 1, 1]),3)
assert_equals(check_match("??.??.??????#?",[1, 1, 4, 2]),12)
assert_equals(check_match("#?????#???",[1, 5, 2]),1)
assert_equals(check_match("?.?????????",[1, 1]),37)
assert_equals(check_match("?#?#???????",[6, 1]),7)
assert_equals(check_match("#?##?.????????##",[5, 1, 5]),4)
assert_equals(check_match("????##?#????????",[5, 4]),8)
assert_equals(check_match("?#.#??#?#???#??#?#",[2, 4, 1, 1, 4, 1]),1)
assert_equals(check_match("?##?.?#.???",[3, 2, 2]),4)
assert_equals(check_match("?.??#??##.?##???",[7, 3]),2)
assert_equals(check_match("?.#????.????",[4, 1, 1]),3)
assert_equals(check_match("#???.??.????##?",[2, 1, 2, 1, 3]),5)
assert_equals(check_match("##?.????????#??",[2, 4, 1, 2]),4)
assert_equals(check_match("????#?#.?????",[5, 2, 1]),3)
assert_equals(check_match("???#?.?????#?????#",[3, 11]),2)
assert_equals(check_match("?????###.#???",[8, 1, 2]),1)
assert_equals(check_match("??.???.?#??#.?.???",[1, 1, 1, 4, 1, 3]),2)
assert_equals(check_match("???.??.?",[1, 1, 1]),9)
assert_equals(check_match("?###???.#???#???#",[6, 1, 2, 2]),4)
assert_equals(check_match("#?.????.????????",[1, 1, 1, 1, 5]),9)
assert_equals(check_match("??#???#?.?#??.?#?",[7, 3, 1]),4)
assert_equals(check_match("??##?.????#??.????",[5, 5, 1, 1]),13)
assert_equals(check_match("?????#??##?#??",[3, 8]),3)
assert_equals(check_match("???###??????.??#",[8, 1]),4)
assert_equals(check_match("??##??.???#",[4, 1]),3)
assert_equals(check_match("?.??#?#??#?",[2, 5]),1)
assert_equals(check_match("#???.#??????",[4, 1, 1, 1]),6)
assert_equals(check_match("???#.???#.#??#?",[2, 3, 1, 3]),1)
assert_equals(check_match("?????##???#.??.#",[1, 6, 1, 1, 1]),6)
assert_equals(check_match("#?.?#?#????##????",[2, 13]),2)
assert_equals(check_match("??#????.#??#??#???",[1, 1, 1, 1, 7]),9)
assert_equals(check_match("#.?.#?.???",[1, 2, 2]),2)
assert_equals(check_match("?#???#?#?.???#??#???",[8, 7]),8)
assert_equals(check_match("??????.???",[2, 1, 3]),6)
assert_equals(check_match("#??????.???#?",[3, 3, 1, 2]),3)
assert_equals(check_match("???.#?????",[1, 1, 1]),16)
assert_equals(check_match("???.?##?#?#??.?.#",[1, 9, 1, 1]),3)
assert_equals(check_match("????#??#??????",[3, 5, 1]),8)
assert_equals(check_match("???.??#?????",[1, 6]),10)
assert_equals(check_match("?#???#???????#",[5, 4]),1)
assert_equals(check_match("?#????#?",[2, 3]),4)
assert_equals(check_match("????#.#??#",[4, 1, 1]),1)
assert_equals(check_match("???##?#????#?#?",[1, 5, 6]),4)
assert_equals(check_match("???##??#???#?#.?",[7, 4]),2)
assert_equals(check_match("???#??????#??.??",[6, 1, 2, 1, 1]),2)
assert_equals(check_match("???????.??",[1, 5, 1]),2)
assert_equals(check_match("?????.????#",[4, 2, 1]),4)
assert_equals(check_match("???#??#??#??.?",[5, 2, 1]),5)
assert_equals(check_match("??.#?????",[1, 1, 2]),7)
assert_equals(check_match("?.????.??#.???#",[1, 1, 1, 1, 4]),10)
assert_equals(check_match("??##???.?.?????",[4, 1, 1, 1]),54)
assert_equals(check_match("?#?.??????????",[3, 2, 1, 1]),35)
assert_equals(check_match("???#???.??##??#",[4, 1, 7]),3)
assert_equals(check_match("?????????###????",[7, 6]),3)
assert_equals(check_match("????.#?????#????",[1, 1, 4, 3]),10)
assert_equals(check_match("??#?#?##?????#",[3, 2, 3, 1]),1)
assert_equals(check_match("???.??????.##.?",[2, 1, 1, 2, 1]),21)
assert_equals(check_match("???#?????",[3, 1]),9)
assert_equals(check_match("?????.???#???#?",[5, 2, 3]),3)
assert_equals(check_match("##????????#???#??##?",[2, 1, 2, 4, 1, 3]),8)
assert_equals(check_match("?.#??????.?",[1, 2, 1, 1]),10)
assert_equals(check_match("?.?#?.??.?#",[1, 1, 1, 2]),2)
assert_equals(check_match("??#?.???.??",[2, 2, 1]),8)
assert_equals(check_match("??????##.????#????",[1, 6, 5, 2]),3)
assert_equals(check_match("?????.???#??#?#",[3, 9]),3)
assert_equals(check_match("?##???#.#?.???",[6, 2]),1)
assert_equals(check_match("??.??.????#?#",[1, 1, 3, 3]),4)
assert_equals(check_match("#??#???.?#??",[1, 3, 1, 2]),2)
assert_equals(check_match("#?#.#????",[3, 1, 2]),2)
assert_equals(check_match("?????.???##",[2, 1, 2]),11)
assert_equals(check_match("???#??#???.#???#.?",[5, 1, 1, 2, 1]),6)
assert_equals(check_match("?##????.#?#?#??#?.??",[5, 1, 9, 1]),2)
assert_equals(check_match("?.?????#?.?##???#?##",[4, 1, 9]),1)
assert_equals(check_match("#???#.??.?",[5, 1]),3)
assert_equals(check_match("#??#??#?.#??.#???",[1, 6, 2, 3]),1)
assert_equals(check_match("??##.?.##?#??.?",[3, 1, 2, 2, 1]),1)
assert_equals(check_match("?????##????#????.?",[9, 4]),3)
assert_equals(check_match("#?.??????.?",[2, 1, 3, 1]),3)
assert_equals(check_match("#???????????????#?",[3, 12]),2)
assert_equals(check_match("???.?.??#?#??????",[2, 7, 2]),6)
assert_equals(check_match("?#####????#???#??#??",[11, 5]),4)
assert_equals(check_match("??.?.#?????",[1, 5]),3)
assert_equals(check_match("????#.?#????",[1, 1, 3]),7)
assert_equals(check_match("#????#?.??#.?#.?",[6, 3, 2]),1)
assert_equals(check_match("??###???##???.???",[9, 1, 2]),6)
assert_equals(check_match("??.?#?#???????.?",[1, 7, 1, 1, 1]),2)
assert_equals(check_match("?#?.##?##??.#??",[2, 5, 2]),2)
assert_equals(check_match("????????#.?",[6, 1]),3)
assert_equals(check_match("#?????#??##?.?.#???",[7, 3, 1, 1, 1]),4)
assert_equals(check_match("?#?.?????????",[1, 7]),3)
assert_equals(check_match("#???????#.???",[5, 3, 1]),3)
assert_equals(check_match("?#?#???#.???",[7, 2]),2)
assert_equals(check_match("??#??.?#????.??",[1, 1, 1, 3, 1]),11)
assert_equals(check_match("?.#???.???",[1, 1, 1]),12)
assert_equals(check_match("?????.???##??",[1, 5]),16)
assert_equals(check_match("??##???.?",[6, 1]),2)
assert_equals(check_match("??.###?##?",[1, 6]),2)
assert_equals(check_match("??.??????#?##",[1, 1, 1, 4]),13)
assert_equals(check_match("????.???.?#??##?",[1, 6]),14)
assert_equals(check_match("?????#??#?#?.#??????",[3, 4, 2, 2]),11)
assert_equals(check_match("?????.?.?#?",[3, 1]),3)
assert_equals(check_match("#???#????.?#?",[1, 2, 1, 2]),10)
assert_equals(check_match("##??.????#??##???",[2, 9]),4)
assert_equals(check_match("??#???????????.?.???",[1, 1, 9, 1, 2]),4)
assert_equals(check_match("???#?##?.?##?",[8, 3]),2)
assert_equals(check_match("?.?#?##????????.#.??",[7, 2, 1, 1, 1]),8)
assert_equals(check_match("?#??????#??#?#??",[2, 11]),5)
assert_equals(check_match("????.?#?#?#????????",[3, 6, 5]),10)
assert_equals(check_match("????.??#.???.??",[1, 2, 1, 3, 2]),1)
assert_equals(check_match("?#.??.?.??.???",[1, 1, 1, 3]),8)
assert_equals(check_match("???#??##???.#?#??",[3, 3, 2, 5]),1)
assert_equals(check_match("#??###????",[1, 3, 1]),3)
assert_equals(check_match("?.????.?",[1, 1, 1]),10)
assert_equals(check_match("?#???#.?",[1, 1]),1)
assert_equals(check_match("###?#?.#?#.???.??",[5, 3, 1, 1]),7)
assert_equals(check_match("?.???.####?#?#?",[1, 4, 3]),4)
assert_equals(check_match("#?#?.#???.????",[1, 1, 2, 1, 1]),7)
assert_equals(check_match("????????.????",[2, 1, 2]),56)
assert_equals(check_match("??##????#??????#????",[4, 12]),9)
assert_equals(check_match("?#?????#?????.???",[2, 3, 6, 2]),2)
assert_equals(check_match("????????#???",[1, 4]),22)
assert_equals(check_match("?????????###??###??",[3, 8]),6)
assert_equals(check_match("???????#?.?",[5, 2, 1]),3)
assert_equals(check_match("###.??.?##??###",[3, 1, 7]),2)
assert_equals(check_match("?????#?#??#???#.?",[1, 12, 1]),2)
assert_equals(check_match("????#????#??#.??",[13, 1]),2)
assert_equals(check_match("???????#??.??.??",[4, 1]),16)
assert_equals(check_match("?????#?#?#???#???",[1, 9, 1, 1]),6)
assert_equals(check_match("??##.????.?",[4, 1, 1]),7)
assert_equals(check_match("????.??.##????#",[3, 1, 7]),4)
assert_equals(check_match("??.?#.???",[1, 1, 1]),7)
assert_equals(check_match("??#??#?#?.???#",[5, 1, 1, 2]),1)
assert_equals(check_match("?####??#???.????#.?",[5, 3, 4]),3)
assert_equals(check_match("?#???#????##",[7, 2]),2)
assert_equals(check_match("#??#??#??.##?",[4, 2, 3]),2)
assert_equals(check_match("?.#???#???.??????",[1, 2, 6]),2)
assert_equals(check_match("?.?????#?##????????",[10, 3]),10)
assert_equals(check_match("?#?.?????###??#?????",[3, 1, 7, 2]),18)
assert_equals(check_match("??????##??#?#???#",[2, 3, 8]),3)
assert_equals(check_match("#?#?????#?",[4, 1, 1]),2)
assert_equals(check_match("????#?#?.#.???????",[2, 3, 1, 4]),8)
assert_equals(check_match("?????????#??????.?",[1, 9]),21)
assert_equals(check_match("?????#???????",[2, 3, 1]),32)
assert_equals(check_match("#?#??.?##???",[3, 5]),2)
assert_equals(check_match("???#???.??#??#??",[1, 1, 1, 3, 1, 1]),8)
assert_equals(check_match("#?.???.????",[1, 1, 4]),3)
assert_equals(check_match("##?#??#?###?.??",[4, 6, 2]),2)
assert_equals(check_match("#??????????#?#??",[1, 14]),1)
assert_equals(check_match("?#???##???.??.????",[3, 3, 1, 1, 1, 2]),8)
assert_equals(check_match("#?.????#???#?.?????",[1, 1, 4, 1, 1, 1]),19)
assert_equals(check_match("#??#?.??#??#",[2, 2, 6]),1)
assert_equals(check_match("??.????????#??.???",[1, 1, 1, 1, 3, 1]),95)
assert_equals(check_match("?.?????###?",[1, 2, 4]),6)
assert_equals(check_match("??#?#?#?#???#?",[8, 1]),2)
assert_equals(check_match("#?#??.?#??#??????",[4, 8]),2)
assert_equals(check_match("?.??###??.?",[5, 1]),4)
assert_equals(check_match("???##????.#?",[1, 4, 1, 1]),4)
assert_equals(check_match("??.???.??????.?",[3, 4]),3)
assert_equals(check_match("?.????.??#?",[3, 3]),4)
assert_equals(check_match("??#??##?.#?.?",[1, 3, 2, 1]),2)
assert_equals(check_match("??#?????????#??",[4, 4, 1]),9)
assert_equals(check_match("?#??????.##????",[2, 1, 1, 2, 1]),27)
assert_equals(check_match("?###??#??#?????#??#",[6, 10]),1)
assert_equals(check_match("???.#????????",[2, 8]),2)
assert_equals(check_match("????????#???#????",[1, 1, 3, 2, 2]),65)
assert_equals(check_match("?????.??#?#?",[1, 1, 5]),12)
assert_equals(check_match("?.????#???.?",[1, 1, 5, 1]),3)
assert_equals(check_match("##??#???.#?",[3, 3, 1]),1)
assert_equals(check_match("????.???.?????#?##?",[2, 1, 1, 1, 4]),55)
assert_equals(check_match("?#?##.????.??",[5, 1, 1, 2]),3)
assert_equals(check_match("#?.?.??.#????#??#???",[1, 1, 10, 1]),3)
assert_equals(check_match("????????##??????#??",[4, 6, 4]),19)
assert_equals(check_match("?????#??.#",[1, 4, 1]),6)
assert_equals(check_match("?????#??#?",[3, 4]),2)
assert_equals(check_match("??#?????????#??#",[1, 11]),1)
assert_equals(check_match("?????.??#??.?????",[1, 4, 3]),30)
assert_equals(check_match("?.?#.?????###?#.??",[1, 2, 1, 6, 1]),7)
assert_equals(check_match("???.???#??.???##?#",[2, 4, 5]),6)
assert_equals(check_match("?.???#.???#?###??#",[1, 1, 1, 1, 5, 1]),4)
assert_equals(check_match("??#.#??????????",[1, 1, 2, 5, 1]),3)
assert_equals(check_match("??.????##????.???",[2, 2, 7, 1]),3)
assert_equals(check_match("??.??#???????.??.?",[1, 7, 1, 1]),32)
assert_equals(check_match("???.?.???.?",[1, 1, 3, 1]),4)
assert_equals(check_match("????.??.?#???.??",[2, 1, 1, 2, 1, 1]),12)
assert_equals(check_match("?###???#???????##",[4, 2, 3, 2]),10)
assert_equals(check_match("?##??.#???",[5, 1]),1)
assert_equals(check_match("?#??##?#?#??#?#???",[9, 4]),2)
assert_equals(check_match("##?#?.##?????",[4, 2, 1]),4)
assert_equals(check_match("??#????????",[3, 3]),12)
assert_equals(check_match("??#??#???#?.??#?",[5, 3, 1, 1]),3)
assert_equals(check_match("??#??#?????.?.#???",[10, 1, 1]),6)
assert_equals(check_match("??#???.????",[5, 1]),8)
assert_equals(check_match("#????#???.??",[4, 3, 1]),2)
assert_equals(check_match("?##?????#?",[6, 2]),3)
assert_equals(check_match("##?#?##???????",[7, 5]),2)
assert_equals(check_match("?#??.??#????#??#???",[1, 5, 2, 4]),4)
assert_equals(check_match("???#???.#??#.?#???",[7, 2, 1, 4]),2)
assert_equals(check_match("?????.???.?.??.??",[1, 2, 1]),92)
assert_equals(check_match("???.#.?.?????",[1, 1]),9)
assert_equals(check_match("????????#?#?#",[2, 2, 1, 3]),6)
assert_equals(check_match("?#???????#.???##",[1, 4, 1, 3]),3)
assert_equals(check_match("?.????.?????????",[1, 1, 1, 5, 2]),9)
assert_equals(check_match("???.?????#",[3, 1]),3)
assert_equals(check_match("???.?#????.?#",[1, 2, 1, 1]),15)
assert_equals(check_match("??#?.#??.?",[1, 3]),1)
assert_equals(check_match("?.??????#.?????",[1, 4, 1, 1, 2]),6)
assert_equals(check_match("#????.#?#????",[1, 2, 6]),2)
assert_equals(check_match("#?##??#??.#??#?",[1, 6, 2, 1]),1)
assert_equals(check_match("???????#?#???##??#",[12, 3, 1]),1)
assert_equals(check_match("??#?.??#???????.#",[1, 1, 1, 1, 3, 1]),10)
assert_equals(check_match("?.?????##??.?#?????",[8, 5]),4)
assert_equals(check_match("#?.?.??",[1, 1]),3)
assert_equals(check_match("#??#?.?",[1, 1, 1]),1)
assert_equals(check_match("???#.?.????.#?##",[1, 1, 1, 2, 4]),9)
assert_equals(check_match("#?.???#??#???.#?#???",[2, 2, 1, 2, 2, 4]),1)
assert_equals(check_match("##?#.??.???????",[4, 1, 1, 1, 1]),21)
assert_equals(check_match("?#?#?????",[1, 1, 2]),3)
assert_equals(check_match("???#???.??#.???",[4, 3, 2]),8)
assert_equals(check_match("?#.#???###?#?#?#?",[1, 13]),1)
assert_equals(check_match("#??#??#??????#????",[1, 7, 1, 1, 1, 1]),3)
assert_equals(check_match("#?.#??#????.??.?###?",[1, 2, 2, 1, 1, 4]),8)
assert_equals(check_match("?#?#?.??????.????",[3, 4, 1]),13)
assert_equals(check_match("???.#?.??#.?.???#",[2, 1, 1, 1, 1, 3]),2)
assert_equals(check_match("????.?????#?#?",[2, 8]),6)
assert_equals(check_match("?#????###???",[1, 4]),2)
assert_equals(check_match("??#?##?????????.?",[9, 2, 1, 1]),4)
assert_equals(check_match("???#??????????#.?",[6, 1, 1, 1]),38)
assert_equals(check_match("??#???#????##??#?",[5, 6]),2)
assert_equals(check_match("??##???.??.#?",[2, 1]),1)
assert_equals(check_match("?#?#?##???????????#?",[10, 1, 5]),8)
assert_equals(check_match("?.#?????.?.#????#??",[1, 2, 7]),4)
assert_equals(check_match("?##?.????????",[2, 3, 1]),10)
assert_equals(check_match("???.###????.#?",[2, 4, 2]),2)
assert_equals(check_match("??????.???",[1, 1, 2]),21)
assert_equals(check_match("#???.????????.#?",[1, 1, 2, 2, 1]),24)
assert_equals(check_match("#.???????#?",[1, 3]),2)
assert_equals(check_match("?.##??.?#?",[3, 2]),2)
assert_equals(check_match("#.?#.????##?#????.#",[1, 1, 3, 5, 1]),2)
assert_equals(check_match("?#?????#?#?????",[5, 1, 1, 1, 2]),2)
assert_equals(check_match("??.#??.?.???.?.#.??#",[1, 3, 2, 1, 1, 3]),4)
assert_equals(check_match("?.?#???#??",[1, 4]),2)
assert_equals(check_match("??.#??#?.?#????",[1, 4, 1, 1]),6)
assert_equals(check_match("?.?#????.?.#?#",[2, 2, 3]),3)
assert_equals(check_match("?##?.??#?#?.?#",[3, 1, 2, 1]),2)
assert_equals(check_match("?.??.???.???#???.?",[1, 2, 3, 3, 1]),6)
assert_equals(check_match("??##?#???####?#???",[4, 1, 5, 1, 2]),1)
assert_equals(check_match("#.#??????????????#??",[1, 1, 3, 1, 1, 6]),15)
assert_equals(check_match("#?.?.?.#.#?.??????",[1, 1, 1, 1, 1, 4]),5)
assert_equals(check_match("???#?#.???",[1, 3, 2]),4)
assert_equals(check_match("#?#??#??.##?",[1, 2, 1, 3]),1)
assert_equals(check_match("??#??#?????",[6, 1]),9)
assert_equals(check_match("???.?#???.?",[1, 1, 2]),5)
assert_equals(check_match("?.#.???#??##???",[1, 4, 4]),3)
assert_equals(check_match("?.#??.#?",[1, 1]),1)
assert_equals(check_match("??.????#????.?",[1, 3, 1, 3]),2)
assert_equals(check_match("???????#?#??????#",[1, 1, 2, 5, 1]),7)
assert_equals(check_match("?#???????##?.???",[3, 6, 2]),8)
assert_equals(check_match("?#????#????",[2, 2, 1]),11)
assert_equals(check_match("??????#???#",[1, 5]),5)
assert_equals(check_match("?.????#??.?.??",[6, 1]),6)
assert_equals(check_match("??.??#????#?",[1, 1, 1, 5]),2)
assert_equals(check_match("?##.???.?.?#",[2, 1, 2]),4)
assert_equals(check_match("????#???????",[1, 2, 1, 2]),21)
assert_equals(check_match("#.???#?????",[1, 7]),3)
assert_equals(check_match("???????#?#.?",[2, 2, 3, 1]),3)
assert_equals(check_match("?.???#????????#?",[1, 3, 4]),15)
assert_equals(check_match("????????.?",[3, 2, 1]),7)
assert_equals(check_match("?.????#?.?????????",[1, 1, 3, 6, 1]),9)
assert_equals(check_match("??.#.?#????",[1, 1, 3, 1]),6)
assert_equals(check_match("??#???????#?.?",[5, 1]),3)
assert_equals(check_match("#?.??##?.????#",[1, 5, 1]),1)
assert_equals(check_match("???.?????#??",[3, 6]),3)
assert_equals(check_match("?.????.???????##?",[2, 9]),6)
assert_equals(check_match("?##.???????",[2, 1, 4]),3)
assert_equals(check_match("?#?????????????#.?",[6, 4, 1, 1]),11)
assert_equals(check_match("??#?##?#??",[5, 1, 1]),1)
assert_equals(check_match("??#????#??????#??",[3, 3, 1, 3]),45)
assert_equals(check_match("????.?#.?#?????",[1, 1, 3, 2]),12)
assert_equals(check_match("??#???.#?.?.??",[6, 1, 1, 1]),2)
assert_equals(check_match("?.????#?.#?",[1, 1, 2, 1]),6)
assert_equals(check_match("???#?#?????#?????.??",[6, 1, 1, 1, 1, 1]),47)
assert_equals(check_match("?????#?#???#??#?#?",[7, 8]),3)
assert_equals(check_match("#.#.??.#??#?##??",[1, 1, 1, 1, 6]),4)
assert_equals(check_match("????.?#?#??",[3, 6]),2)
assert_equals(check_match("?#.?.#??????",[2, 1, 2, 1]),7)
assert_equals(check_match("??#?#??????????#",[11, 1]),3)
assert_equals(check_match("?.#??####?????????#?",[1, 1, 4, 2, 1, 2]),16)
assert_equals(check_match("?.?.?#?.??#??",[1, 2, 3]),12)
assert_equals(check_match("????#???#????#?.????",[1, 3, 1, 5, 2]),18)
assert_equals(check_match("???#?.????",[3, 3]),4)
assert_equals(check_match("?##??##.???.#?.##",[3, 2, 1, 2, 2]),6)
assert_equals(check_match("?###??#?.?#.#???",[4, 3, 1, 2, 1]),1)
assert_equals(check_match("?????????##?????",[2, 8, 2]),10)
assert_equals(check_match("?.?#?.??#??????",[3, 5, 1]),6)
assert_equals(check_match("#.??#???#????#.???",[1, 12, 1]),3)
assert_equals(check_match("?#????##?",[2, 2]),2)
assert_equals(check_match("???????#???##???",[2, 5, 5]),10)
assert_equals(check_match("???#??#??.#???.#.#",[3, 3, 2, 1, 1, 1]),3)
assert_equals(check_match("???#.#?????#??.?##",[1, 1, 1, 1, 3, 2]),13)
assert_equals(check_match("#????????#",[3, 1, 1]),4)
assert_equals(check_match("???#.#??#?",[2, 4]),1)
assert_equals(check_match("????.##???#???.???",[1, 1, 9, 1, 1]),3)
assert_equals(check_match("?.???#?#?.?#????",[6, 4]),4)
assert_equals(check_match("????????#?.#?",[2, 1]),2)
assert_equals(check_match("????#????##????",[1, 8, 1]),12)
assert_equals(check_match("?.???????#",[2, 4]),2)
assert_equals(check_match("?.?#??#?##?",[1, 7]),1)
assert_equals(check_match("?#???.#??.???##??",[2, 2, 4]),6)
assert_equals(check_match("?##.????##???",[2, 5]),4)
assert_equals(check_match("??.?#.?.#?#???",[1, 2, 1, 6]),2)
assert_equals(check_match("???#??.?#??????#",[4, 9]),3)
assert_equals(check_match("?????.????###",[5, 6]),1)
assert_equals(check_match("##.#??#????",[2, 8]),1)
assert_equals(check_match("??#??.?????#?#?",[1, 1, 1, 3, 4]),3)
assert_equals(check_match("##??#.??#??",[2, 1, 2]),2)
assert_equals(check_match("??##?###.##?#?",[1, 6, 4]),1)
assert_equals(check_match("???????#?#",[2, 1, 3]),6)
assert_equals(check_match("??.???#?#.??##?",[1, 2, 1, 1, 5]),2)
assert_equals(check_match("?#???#?#.?#?#??#.?",[2, 4, 2, 4]),2)
assert_equals(check_match("??????.???",[1, 1]),29)
assert_equals(check_match("???????????",[1, 1, 4]),20)
assert_equals(check_match("???#?#?????##??",[7, 4]),9)
assert_equals(check_match("?##??????",[3, 1, 2]),4)
assert_equals(check_match("?.#?.???.?.###??",[1, 2, 3]),3)
assert_equals(check_match("???.??.#.##??",[3, 2, 1, 2]),1)
assert_equals(check_match("?.??.?????#?????#",[1, 1, 1, 7]),17)
assert_equals(check_match("??.#.#.#?#?",[1, 1, 1, 4]),2)
assert_equals(check_match("##?##???.?????##??.?",[2, 2, 1, 8, 1]),4)
assert_equals(check_match("?.???.??.?????.?.??",[2, 4]),6)
assert_equals(check_match("??.???????",[1, 2]),22)
assert_equals(check_match("?????#????????.#.???",[1, 4, 3, 1, 3]),30)
assert_equals(check_match("?????.??#????",[1, 2, 6]),6)
assert_equals(check_match("?##???##.??.?",[8, 1, 1]),2)
assert_equals(check_match("##???????",[3, 1]),5)
assert_equals(check_match("?#?#??????????#?##?",[3, 7, 1, 2]),2)
assert_equals(check_match("#????#??.###?##.??",[1, 4, 1, 6, 1]),2)
assert_equals(check_match("??#.??#??.?",[1, 5]),1)
assert_equals(check_match("?#?#???#???##",[1, 2, 7]),1)
assert_equals(check_match("??????#?###??.?",[2, 9, 1]),3)
assert_equals(check_match("???.??##?##.??",[1, 4, 2]),3)
assert_equals(check_match("?????.?????",[1, 1, 1, 1]),46)
assert_equals(check_match("??.?.????#??#?.?",[1, 1, 6, 1, 1]),2)
assert_equals(check_match("?.#??#?#?#??",[2, 5]),1)
assert_equals(check_match("????#???????.#",[6, 1, 3, 1]),1)
assert_equals(check_match("?.???#????",[1, 7]),2)
assert_equals(check_match("?#???#????#?##??",[5, 7]),3)
assert_equals(check_match("????.?#??#??#???.?",[1, 9]),8)
assert_equals(check_match("???##?#.???.?.?",[6, 1]),5)
assert_equals(check_match("#??#??.??##?#????",[1, 2, 9]),4)
assert_equals(check_match("?.????#???????",[2, 9]),1)
assert_equals(check_match("???????.?#",[1, 2, 1]),10)
assert_equals(check_match("#?.??#???.??#?#",[2, 3, 5]),3)
assert_equals(check_match("????.??.??.?",[1, 1]),31)
assert_equals(check_match("??????##.????",[3, 2, 1]),13)
assert_equals(check_match("???.?????#?.##?",[2, 4, 3]),5)
assert_equals(check_match("#.??#???#.?#?????#??",[1, 4, 1, 1, 1, 2]),10)
assert_equals(check_match("??.?#????.??#?",[2, 6, 1, 1]),1)
assert_equals(check_match("#?#.?????.??####???",[1, 1, 1, 2, 6, 2]),3)
assert_equals(check_match("??.???##?#???##",[7, 3]),2)
assert_equals(check_match("???.??#??",[1, 3]),10)
assert_equals(check_match("??##.??????",[3, 1]),6)
assert_equals(check_match("##????#???#?#??#??",[13, 2]),2)
assert_equals(check_match("??#??#?.#",[7, 1]),1)
assert_equals(check_match("?????#?.?#????#??",[7, 1, 3]),3)
assert_equals(check_match("??#??.??????#",[4, 3, 2]),4)
assert_equals(check_match("??#?#.??###.??.?",[3, 3, 1, 1]),2)
assert_equals(check_match("?#.??#??.?#?.??",[2, 3, 2, 1]),12)
assert_equals(check_match("??#?#?#?##",[1, 5, 2]),1)
assert_equals(check_match("?.#???.??#???#??#?",[4, 4, 5]),3)
assert_equals(check_match("?.??#??.#?.?#??#?",[1, 2, 1, 2, 1, 3]),1)
assert_equals(check_match("??#??.???????#?#?.??",[3, 7]),6)
assert_equals(check_match("?.??#?#?.????#",[5, 1, 1]),6)
assert_equals(check_match("??#?.?##.#??",[1, 2, 3, 3]),1)
assert_equals(check_match("???.#????",[3, 1, 2]),2)
assert_equals(check_match("???#?.????????",[2, 6]),6)
assert_equals(check_match("?.??###???.#.????",[5, 1, 1, 4]),3)
assert_equals(check_match("??#??.??????",[4, 2, 1, 1]),2)
assert_equals(check_match("??.????#.?",[1, 2]),4)
assert_equals(check_match("#???.?.????????#",[1, 2, 1, 2, 1]),17)
assert_equals(check_match("???#???????#??#?.??",[2, 2, 4, 1, 1]),13)
assert_equals(check_match("#??#???#?#??#.???",[5, 1, 4, 2]),2)
assert_equals(check_match("?##??????#",[7, 1]),2)
assert_equals(check_match("?#?????.?",[6, 1]),2)
assert_equals(check_match("????.?#.???###??",[1, 1, 7]),8)
assert_equals(check_match("????#.#??",[2, 1, 3]),2)
assert_equals(check_match("??.#????.??",[1, 4, 2]),2)
assert_equals(check_match("????#??.???#?",[6, 4]),4)
assert_equals(check_match("?.????#??#?##?.?.??",[11, 1]),6)
assert_equals(check_match("?????#.?.????????.#",[1, 2, 2, 4, 1]),9)
assert_equals(check_match("?????###?#?????",[1, 1, 3, 1, 1]),12)
assert_equals(check_match("?#??##?#??##",[2, 8]),2)
assert_equals(check_match("??.?????#??##",[1, 1, 1, 2, 3]),2)
assert_equals(check_match("????#.???#??###",[1, 1, 1, 1, 3]),7)
assert_equals(check_match("??.##?????##.??.?",[1, 5, 3, 1, 1]),4)
assert_equals(check_match("??#?#?????#",[6, 1]),3)
assert_equals(check_match("?????#???????????",[8, 4]),15)
assert_equals(check_match("?.???????#",[4, 1]),3)
assert_equals(check_match("??????.????",[5, 1]),8)
assert_equals(check_match("????????#?.??????",[6, 3]),9)
assert_equals(check_match("???#???.???#",[5, 2]),3)
assert_equals(check_match("??????.????#??##",[2, 9]),5)
assert_equals(check_match("#???#???.??",[5, 1]),4)
assert_equals(check_match("???????#.??##??",[1, 2, 6]),5)
assert_equals(check_match("???#????##????????",[2, 9]),8)
assert_equals(check_match("?#?.????#??#???#??",[2, 1, 11]),6)
assert_equals(check_match("#??????#???####??.?",[8, 6]),3)
assert_equals(check_match("????#?#????",[3, 3]),3)
assert_equals(check_match("??###.?.??????",[5, 1, 1]),16)
assert_equals(check_match("????#???#?#?#?##?",[1, 2, 9]),10)
assert_equals(check_match("?####?.?.#",[5, 1, 1]),2)
assert_equals(check_match("??##?#??#?",[2, 1, 2]),2)
assert_equals(check_match("?.??##?.?.?##?##???",[5, 3, 3]),1)
assert_equals(check_match("#??#.##?####?#???",[4, 9]),1)
assert_equals(check_match("?#??.#????#.?.??",[3, 2, 3, 1, 1]),4)
assert_equals(check_match("?????##????#?#??##?#",[9, 4, 2, 1]),3)
assert_equals(check_match("????#???????",[3, 2, 3]),4)
assert_equals(check_match("???????#?#??##?#?",[2, 1, 7, 1]),6)
assert_equals(check_match("????????#?#????",[2, 1, 4]),22)
assert_equals(check_match("?#.#?##??##",[2, 5, 2]),1)
assert_equals(check_match("??#?#?????#.?#?.?#",[9, 3, 1]),1)
assert_equals(check_match("??.?#???##?????.??",[11, 1]),4)
assert_equals(check_match("?.#??????##???#??",[1, 1, 1, 3, 3]),26)
assert_equals(check_match("?#???.??????????#?",[3, 1, 3, 1, 4]),11)
assert_equals(check_match("?#.?????.#?",[2, 1, 1]),5)
assert_equals(check_match("????.?????",[3, 1, 2]),6)
assert_equals(check_match("#?.#?????#????",[2, 7, 1]),3)
assert_equals(check_match("??#.?#?#?##??.#?.?",[1, 1, 2, 5, 1]),1)
assert_equals(check_match("??????#????",[2, 3]),10)
assert_equals(check_match("??#??.?.?.??.?",[3, 1]),16)
assert_equals(check_match("?#?#.#?.????",[2, 1, 1, 3]),2)
assert_equals(check_match("#.?.????#?????",[1, 1, 1, 4, 1]),11)
assert_equals(check_match("??#????????",[4, 4]),6)
assert_equals(check_match("??????.????????#??",[4, 1, 1, 3]),111)
assert_equals(check_match("?#?.????",[2, 2]),6)
assert_equals(check_match("??#??#.??#",[4, 2]),1)
assert_equals(check_match("??????.?????#?",[4, 1, 1, 3]),8)
assert_equals(check_match("##?#???#?????.#?",[2, 7, 1, 2]),2)
assert_equals(check_match("??#?????#.??#?",[4, 3, 3]),4)
assert_equals(check_match("???#????????",[9, 1]),3)
assert_equals(check_match("?.?.#????#??#??.??##",[1, 10, 3]),2)
assert_equals(check_match("?###?#.#.?",[6, 1, 1]),1)
assert_equals(check_match("?#??.????#?#?",[1, 1, 6]),3)
assert_equals(check_match("#.?????##?#?",[1, 1, 6]),5)
assert_equals(check_match("???.?.#????##?#?",[1, 1, 1, 1, 4]),9)
assert_equals(check_match("?????????.?#???",[1, 1, 2]),65)
assert_equals(check_match("????#??#??##?",[1, 2, 1, 2]),5)
assert_equals(check_match("??#??.?###??????.?",[3, 8]),6)
assert_equals(check_match("?#????????",[3, 1, 1]),16)
assert_equals(check_match("???#?#???#??.?#",[4, 4, 1]),3)
assert_equals(check_match("?.#??.????#????????",[1, 1, 7, 1, 1, 1]),2)
assert_equals(check_match("???.??#?##????#?",[1, 8, 1]),6)
assert_equals(check_match("???.?.???????#?????",[1, 1, 1, 1, 6, 1]),40)
assert_equals(check_match("??#?.???#???",[4, 4, 1]),3)
assert_equals(check_match("????????#?.???.????",[1, 2, 3, 3, 4]),9)
assert_equals(check_match("?????????#??##???",[3, 9]),14)
assert_equals(check_match("#????.???????.???",[5, 4, 1, 1]),13)
assert_equals(check_match("??#?##???????",[6, 5]),3)
assert_equals(check_match("????.?#?.??.#???",[1, 1, 3, 1, 1, 2]),6)
assert_equals(check_match("?.??.##??.#?????.?",[1, 2, 4, 1, 2, 1]),4)
assert_equals(check_match("?#?????????#???.????",[2, 1, 9, 1, 1]),12)
assert_equals(check_match("??.?.?????.?#",[1, 1, 4, 1]),4)
assert_equals(check_match("??##?.#??",[4, 3]),2)
assert_equals(check_match("??#??##.#????????",[1, 1, 3, 4, 3]),2)
assert_equals(check_match("#???????#?#?.??.??",[1, 3, 1, 1, 1, 1]),16)
assert_equals(check_match("????##?#???????????#",[1, 9, 3, 1]),16)
assert_equals(check_match("??#??.????????#?.??",[2, 9, 1]),8)
assert_equals(check_match("??##?#??#.??.#?",[5, 2, 2, 1]),1)
assert_equals(check_match("?###?????????.??.???",[4, 4, 1, 1, 1]),86)
assert_equals(check_match("????.?????????",[2, 2]),39)
assert_equals(check_match("????????##?.?",[2, 1, 3, 1]),16)
assert_equals(check_match("?.?.#?#???#??.?????",[1, 9, 3]),6)
assert_equals(check_match("??????#??.?#?#?.??",[1, 1, 4, 1, 1, 1]),8)
assert_equals(check_match("????#?????????#??",[1, 5, 1, 7]),1)
assert_equals(check_match("?????????#?#??#.???",[4, 8, 1]),10)
assert_equals(check_match("#??#???#.???.?.?",[8, 1]),5)
assert_equals(check_match("?#??#?????.#???",[1, 6, 1]),2)
assert_equals(check_match("???##??#???##???#",[9, 2, 2]),2)
assert_equals(check_match("?#????#.#??????#",[1, 4, 2, 4]),1)
assert_equals(check_match("?????#.?.#?#?",[3, 3]),1)
assert_equals(check_match("????.#.????.??",[3, 1, 1, 1]),22)
assert_equals(check_match("???#?.#????#??#",[2, 9]),2)
assert_equals(check_match("???.###????#????????",[4, 1, 3]),6)
assert_equals(check_match("??.??.?##?#?#????",[2, 2, 2, 6]),1)
assert_equals(check_match("???.???#?#???#??#??",[1, 1, 1, 2, 5, 3]),2)
assert_equals(check_match("????##?##?##???#??",[1, 13]),5)
assert_equals(check_match("??????#????#.#?#?",[9, 1, 4]),2)
assert_equals(check_match("?????#??.#.??????#??",[7, 1, 8]),4)
assert_equals(check_match("??#??????.??",[1, 5, 1]),5)
assert_equals(check_match("??##?##????#??",[1, 2, 5, 1, 1]),1)
assert_equals(check_match("??###??????.?",[4, 2, 1]),11)
assert_equals(check_match("#??????????.??#?.?",[11, 4]),1)
assert_equals(check_match("??.??#?.???#?##??",[1, 1, 1, 4]),13)
assert_equals(check_match("???.?#???????",[1, 3, 2]),22)
assert_equals(check_match("#?#??#.????###",[6, 2, 3]),2)
assert_equals(check_match("??#???##.??#?",[1, 2, 3, 3]),2)
assert_equals(check_match("??#?#?.#?#.?.?###",[6, 1, 1, 1, 3]),1)
assert_equals(check_match("??#????#??????.#",[1, 1, 4, 2, 1]),14)
assert_equals(check_match("?????.??##?#??#?##??",[2, 1, 12]),13)
assert_equals(check_match("??.?.?#????",[1, 4]),6)
assert_equals(check_match("??#???#?.????",[2, 3, 1, 1]),9)
assert_equals(check_match("??.#.???.?????#???",[1, 1, 3, 1, 6]),6)
assert_equals(check_match("???.?##?#?",[2, 3, 1]),2)
assert_equals(check_match("???????#?????",[1, 3, 1]),46)
assert_equals(check_match("??.????#.#",[1, 5, 1]),2)
assert_equals(check_match("??.??#???",[1, 3, 1]),6)
assert_equals(check_match("#??##????#???#?.?",[1, 12]),2)
assert_equals(check_match("#.#?#?????#??##???",[1, 4, 1, 8]),3)
assert_equals(check_match("??????#?#.?",[8, 1]),1)
assert_equals(check_match("?.?.#????#??????",[1, 3, 3, 1, 1]),8)
assert_equals(check_match("????#???.##?#.??.##",[7, 4, 1, 2]),4)
assert_equals(check_match("#.?.???#?.?#",[1, 1, 1, 2]),3)
assert_equals(check_match("?.#???#?#????#???",[3, 1, 8]),1)
assert_equals(check_match("????.##???.#????",[1, 2, 4, 2, 1]),2)
assert_equals(check_match("#??#.???#",[2, 1, 2]),1)
assert_equals(check_match("???.???#?#????",[2, 6]),9)
assert_equals(check_match("??##?.??#.???",[1, 3, 2, 1]),3)
assert_equals(check_match("?#?##????????#?.?",[7, 4]),4)
assert_equals(check_match("????#.??????",[4, 3, 1]),3)
assert_equals(check_match("?#??????#",[5, 1]),2)
assert_equals(check_match("???.???#??#?",[1, 7]),6)
assert_equals(check_match("?#????.?#??#?",[5, 4]),2)
assert_equals(check_match("#????????????.??",[1, 1, 7, 2]),6)
assert_equals(check_match("?????#.???#?",[1, 3, 1, 1]),4)
assert_equals(check_match("???????????#???",[3, 1, 1, 6]),5)
assert_equals(check_match("??#????#?????",[2, 2, 2]),11)
assert_equals(check_match("#???#??#???????",[2, 7, 4]),1)
assert_equals(check_match("??????????##???.????",[1, 1, 9, 3]),20)
assert_equals(check_match("????.??.?#?",[1, 1, 2, 2]),6)
assert_equals(check_match("#?????#?#??#????????",[3, 14]),3)
assert_equals(check_match("??#???.?#.?",[1, 1, 2]),3)
assert_equals(check_match("?????????????#?#",[2, 1, 3, 3]),35)
assert_equals(check_match("???#.?????##????",[2, 6, 1, 1]),1)
assert_equals(check_match("?????.##???.?",[3, 4]),3)
assert_equals(check_match("?.#????#?????",[2, 7]),2)
assert_equals(check_match("###?????",[3, 2]),3)
assert_equals(check_match("??#??????.#?#",[4, 1, 1, 1, 1]),4)
assert_equals(check_match("###?#?##?##????",[11, 2]),2)
assert_equals(check_match("??????.??????##?????",[1, 1, 1, 9, 1]),34)
assert_equals(check_match("???#?.?.?.??",[4, 1, 1, 1]),4)
assert_equals(check_match("??#?##?.??#?????.#?",[7, 2, 3, 2]),3)
assert_equals(check_match("???.###??.#??#?",[1, 1, 5, 1, 2]),2)
assert_equals(check_match("?.?#.?#?.?#?????",[1, 2, 1, 2, 1]),9)
assert_equals(check_match("#??????.##?????",[6, 3, 1]),3)
assert_equals(check_match("?#?#.????",[4, 2]),3)
assert_equals(check_match("?.????.?#",[2, 1]),3)
assert_equals(check_match("?.?.?.##??#????##???",[1, 1, 14]),3)
assert_equals(check_match("????#?.#???##?#?????",[3, 1, 9, 1, 1]),1)
assert_equals(check_match("??##????.#?#.#????",[1, 5, 1, 1, 5]),1)
assert_equals(check_match("??#??????.??",[3, 1, 2, 1]),8)
assert_equals(check_match("#?.??#?###??#.?",[2, 2, 4, 1, 1]),1)
assert_equals(check_match("?.#.??#??????",[1, 3, 1]),12)
assert_equals(check_match("??.???##???.#???",[1, 5, 1, 2, 1]),6)
assert_equals(check_match("#??##?#?#?.?????",[5, 1, 1, 1, 1]),6)
assert_equals(check_match("???.???###??",[2, 6]),6)
assert_equals(check_match("?#????#?.?#???#????",[2, 3, 1, 5]),12)
assert_equals(check_match("??#?####?????##???",[6, 4]),3)
assert_equals(check_match("##.??#???.???????",[2, 3, 1, 4]),21)
assert_equals(check_match("??????.#????#?",[1, 3, 2, 4]),3)
assert_equals(check_match("#?.?????.???????#?#",[2, 1, 1, 10]),6)
assert_equals(check_match("??.?????#???.?",[7, 1]),4)
assert_equals(check_match("?###.?#.?.?#",[3, 1, 1, 1]),1)
assert_equals(check_match("#????????.??#????#?#",[1, 5, 2, 1, 1, 1]),9)
assert_equals(check_match("??##?#?#??#?#???#",[8, 7]),2)
assert_equals(check_match("???.?.???????#.??#?",[2, 1, 1, 6, 1, 2]),2)
assert_equals(check_match("??.?????.?#??",[1, 1, 1, 4]),13)
assert_equals(check_match("????#????##?##??",[3, 8]),6)
assert_equals(check_match("?.??????????",[2, 4]),10)
assert_equals(check_match("?????????#?#?",[4, 2, 3]),3)
assert_equals(check_match("#.??#????#??#.?",[1, 1, 2, 2, 1]),4)
assert_equals(check_match("?#.???????.??.?",[1, 1, 5, 2, 1]),1)
assert_equals(check_match("??#?.???????#.??##??",[2, 1, 2, 2, 3, 1]),6)
assert_equals(check_match("???.???.#??.???",[1, 1, 1, 3, 3]),6)
assert_equals(check_match("#?#.???#.???",[3, 1, 1, 2]),4)
assert_equals(check_match("#?##.?????#???.?",[4, 1, 3, 1]),16)
assert_equals(check_match("#?.???????????##??",[1, 1, 2, 8]),10)
assert_equals(check_match("?#??.?????",[2, 2, 1]),6)
assert_equals(check_match("?#?##???#?##??.#?",[1, 2, 1, 2, 1, 1]),1)
assert_equals(check_match("????????#?",[2, 4]),7)
assert_equals(check_match("#?.?##???????.??",[1, 6, 2]),5)
assert_equals(check_match("#.??.##???#???.?",[1, 1, 6, 1, 1]),4)
assert_equals(check_match("?????.###?.??##??#?",[1, 1, 4, 1, 3, 2]),6)
assert_equals(check_match("???#?.??????.?#?",[4, 6, 2]),4)
assert_equals(check_match("????#?#?????",[7, 3]),3)
assert_equals(check_match("???.#??",[3, 3]),1)
assert_equals(check_match("#.?#??????#????#??#",[1, 7, 1, 5, 1]),1)
assert_equals(check_match("???#???.??",[2, 2]),4)
assert_equals(check_match("????.?#.?#???",[3, 1, 4]),4)
assert_equals(check_match("??.#???#???????",[1, 1, 7]),7)
assert_equals(check_match("??#?.??????#",[2, 1, 1, 1]),12)
assert_equals(check_match("??##????.???.?#",[7, 3, 2]),2)
assert_equals(check_match("?#????#???#??.?##?",[1, 3, 2, 3]),10)
assert_equals(check_match("?#.#??????##??###???",[2, 4, 1, 9]),1)
assert_equals(check_match("??#.??###??",[1, 1, 7]),1)
assert_equals(check_match("???????????",[1, 3]),28)
assert_equals(check_match("?????#???",[1, 4]),10)
assert_equals(check_match("??????.??#?#???#??",[1, 1, 9, 1]),10)
assert_equals(check_match("#?.##?#.???#???",[1, 4, 1, 2, 1]),4)
assert_equals(check_match("?###??##????##????",[7, 8]),2)
assert_equals(check_match("#???.?????.?",[1, 1, 3, 1]),9)
assert_equals(check_match("#??????#.?#?",[1, 2, 1, 2]),6)
assert_equals(check_match("?.?#??#????.???",[1, 4, 2]),8)
assert_equals(check_match("#.#????##.###??",[1, 1, 2, 3]),1)
assert_equals(check_match("?.?.????.#?.?",[1, 1, 1, 2, 1]),11)
assert_equals(check_match("?????.#???#????",[3, 8]),3)
assert_equals(check_match("??##?##?????#??#.?",[4, 2, 4, 2]),1)
assert_equals(check_match("?????????#",[1, 1, 5]),3)
assert_equals(check_match("??.??#???#?????",[1, 5, 3, 1]),4)
assert_equals(check_match("?.#??.#?#????#???",[2, 5, 3]),2)
assert_equals(check_match("????.?.#",[2, 1, 1]),4)
assert_equals(check_match("?.?.??????#?#?",[1, 1, 7]),8)
assert_equals(check_match("?##????##????###??.?",[16, 1]),3)
assert_equals(check_match("??????#???#.?.??",[10, 1, 1]),2)
assert_equals(check_match("?.#?#??.#????",[5, 5]),1)
assert_equals(check_match("?????.??#??#???????",[1, 1, 1, 4, 1, 1]),120)
assert_equals(check_match("???????.?.???.??",[5, 1]),19)
assert_equals(check_match("??????##?????????",[2, 8, 1, 1]),15)
assert_equals(check_match("??????##???.????#",[2, 8, 2, 1]),2)
assert_equals(check_match("##.?#?.#??",[2, 2, 1]),2)
assert_equals(check_match("#?.?#.???????#???",[2, 1, 7]),4)
assert_equals(check_match("?.????.??#????????",[4, 6, 1, 1]),4)
assert_equals(check_match("???#?##????",[2, 6]),2)
assert_equals(check_match("???????.#??#???",[4, 4]),4)
assert_equals(check_match("?????.???",[5, 2]),2)
assert_equals(check_match("?.##???????",[2, 4]),3)
assert_equals(check_match("?##??##?????#?????",[8, 3, 1, 1]),8)
assert_equals(check_match("?.#??#?.?",[1, 3]),1)
assert_equals(check_match("?#?????##?.?#???????",[3, 3, 1, 1, 3]),12)
assert_equals(check_match("??.???##??????",[1, 11]),2)
assert_equals(check_match("???????#?.?#????",[9, 2, 1]),5)
assert_equals(check_match("??.?#????#?#?????",[1, 7, 1, 1, 1]),6)
assert_equals(check_match("?.?????????#??#?#??",[1, 1, 11, 1]),5)
assert_equals(check_match("??.?##?????",[1, 3, 1]),14)
assert_equals(check_match("?#?#?????.##??###??",[2, 2, 2, 8]),2)
assert_equals(check_match("????#???#???#??",[2, 11]),3)
assert_equals(check_match("?.????#????##",[5, 3]),3)
assert_equals(check_match("????#??#?#??.?????",[1, 1, 6, 1, 1, 1]),10)
assert_equals(check_match("??#?#??.???.?",[5, 2]),6)
assert_equals(check_match("#??#?.?#??",[2, 1, 4]),1)
assert_equals(check_match("?.??#???#.??",[1, 5, 1]),5)
assert_equals(check_match("??##???#?.???##????",[7, 6]),8)
assert_equals(check_match("#?.?????###???",[2, 1, 8]),3)
assert_equals(check_match("??#?#?#???.#???",[1, 7, 2]),1)
assert_equals(check_match("#.?#??#.??",[1, 4]),1)
assert_equals(check_match("????????#????.#?",[1, 5, 1, 1]),23)
assert_equals(check_match("?#?.???.???",[3, 2]),4)
assert_equals(check_match("?????#?.??#?##.#?",[2, 1, 1, 6, 1]),1)
assert_equals(check_match("??#?.###???#",[2, 3, 3]),2)
assert_equals(check_match("?.?#.?.?#????#",[1, 2, 7]),1)
assert_equals(check_match("?.##?##??#??.#????##",[6, 3, 1, 4]),1)
assert_equals(check_match("#??###??????#",[8, 3]),1)
assert_equals(check_match("????#??#.?",[4, 2]),1)
assert_equals(check_match("???.????.???#??",[3, 1, 5]),8)
assert_equals(check_match("?#????#?#?#?#????#",[1, 13]),1)
assert_equals(check_match("?.?#.#.?.???#??#",[1, 1, 1, 7]),2)
assert_equals(check_match("???.?#??.??##?",[1, 2, 1, 5]),3)
assert_equals(check_match("?.?#?#?#.###???",[1, 1, 1, 1, 6]),1)
assert_equals(check_match("???.???#???#?.#?.?",[1, 6, 2, 1, 1]),3)
assert_equals(check_match("?.?##.????????",[1, 2, 6]),3)
assert_equals(check_match("#.?#???#?.??????",[1, 3, 1, 2, 2]),6)
assert_equals(check_match("#?????#???##??#",[3, 7, 2]),1)
assert_equals(check_match("#.?#??#??.??.??",[1, 1, 4, 1, 1]),4)
assert_equals(check_match("??#??#???##.??##?",[4, 2, 3]),2)
assert_equals(check_match("?#?.#??#??.????",[1, 6, 2]),3)
assert_equals(check_match("##.???.???##??",[2, 1, 5]),10)
assert_equals(check_match("?.#???##?#???",[1, 9, 1]),1)
assert_equals(check_match("????#?##.????#",[4, 2, 1, 2]),2)
assert_equals(check_match("???????##?#?????.?",[4, 8, 1, 1]),4)
assert_equals(check_match("????##?#?#??",[1, 8]),6)

sum = 0
File.readlines("input2.txt").collect(&:chomp).reject(&:empty?).each do |line|
  s, c = line.split(" ")
  s = reduce_dots(trim(Array.new(5,s).join("?")))
  c = Array.new(5,c).join(",").split(",").collect(&:to_i)
  # s = reduce_dots(trim(s))
  # c = c.split(",").collect(&:to_i) 
  res = check_match(s, c)
  puts "#{s.inspect} #{c.inspect} => #{res}"
  sum += res
end
puts "-" * 20
puts sum